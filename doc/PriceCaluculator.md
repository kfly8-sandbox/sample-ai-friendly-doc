# 販売価格計算仕様書

## 1. 概要

本仕様書は、ユーザーの会員ステータスおよびセール状況に基づいて適用される販売価格ルールを定義する。

## 2. 販売価格の計算

販売価格は以下の条件に基づいて決定される。

### 2.1 条件

- **プレミアム会員かどうか**: ユーザーがプレミアム会員である場合、10%オフが適用される
- **セールかどうか**: セール期間中である場合、指定の割引が適用される。
- **クーポン券の利用かどうか**: クーポン券を利用する場合、クーポン券の割引率が適用される。ただし、セール商品との併用はできない。

### 2.2 テストケースと適用価格

以下のテーブルに基づいて、価格を適用する。

| 条件/テストケース      | TC001 | TC002 | TC003 | TC004 | TC005 | TC006 |
| -----------------------|-------|-------|-------|-------|-------|-------|
| プレミアム会員かどうか | FALSE | FALSE | TRUE  | TRUE  | FALSE | TRUE  |
| セールかどうか         | FALSE | TRUE  | FALSE | TRUE  | FALSE | FALSE |
| クーポン券の利用       | FALSE | FALSE | FALSE | FALSE | TRUE  | TRUE  |
| 通常価格               | 適用  |       |       |       |       |       |
| 10%オフ                |       | 適用  | 適用  |       | 適用  |       |
| 20%オフ                |       |       |       | 適用  |       | 適用  |

### 2.3 期待結果一覧

|  テストケース| 元の価格 |  適用内容  |  計算式                 | 期待する販売価格 |
|--------------|--------- | -----------|-------------------------|-----------|
| **TC001**    |  100円   |  通常価格  |  100円 × (1.00)         | **100円** |
| **TC002**    |  100円   |  10%オフ   |  100円 × (1 - 0.10)     | **90円**  |
| **TC003**    |  100円   |  10%オフ   |  100円 × (1 - 0.10)     | **90円**  |
| **TC004**    |  100円   |  20%オフ   |  100円 × (1 - 0.20)     | **80円**  |
| **TC005**    |  100円   |  10%オフ   |  100円 × (1 - 0.10)     | **90円**  |
| **TC006**    |  100円   |  20%オフ   |  100円 × (1 - 0.20)     | **80円**  |

## 3. 注意事項

### 3.1 割引率の上限

- 割引率は、0%〜80%までの自然数で、小数になることはない。
  - 割引の上限は、80%までとする。
  - もし掛け合わせて、割引率が小数になるような場合があれば、四捨五入する。

- **TC101 割引率の上限は80%まで**
  - プレミアム会員が100円の商品を80%オフで購入しようとした場合
  - 割引率は10%+80%ではなく、上限の80%が適用され
  - 販売価格は20円となる。

### 3.2 販売価格の端数

- **TC201 販売価格の端数は切り捨てする**
   - 通常会員が90円の商品を25%オフで購入する場合
   - 販売価格は 90円 - (1-25%) = 67.5円 ではなく、
   - 端数の切り捨てを行い、67円となる

### 3.3 セール商品とクーポン券の併用

- **TC301 セール商品とクーポン券は併用できない**
   - セール商品で100円の商品を20%オフで購入しようとした場合、例外を返す


以上のルールに基づき、販売価格が定まる

